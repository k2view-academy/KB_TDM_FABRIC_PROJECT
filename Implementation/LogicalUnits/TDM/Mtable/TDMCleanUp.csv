TABLE_NAME,CLEANUP_ORDER,CLEANUP_IND,CLEANUP_STATEMENT,CLEANUP_LOGIC,SEQ
TASK_REF_EXE_STATS,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_REF_EXE_STATS WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",Clean records which belong to task executions that need to be cleaned,1
TASK_REF_EXE_STATS,1,true,DELETE FROM @TDMDB_SCHEMA@.TASK_REF_EXE_STATS WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE <  ${TRUNC_DATE} ),Task execution belongs to Inactive task that need to be cleaned,2
TASK_EXECUTION_ENTITIES,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXECUTION_ENTITIES WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID::TEXT FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",Entities belong to task execution IDs that need to be cleaned,3
TDM_SEQ_MAPPING,1,true,"DELETE FROM @TDMDB_SCHEMA@.TDM_SEQ_MAPPING WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",Entities belong to task execution IDs that need to be cleaned,4
TASK_EXECUTION_LIST,2,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE}",Task is not pending or running and end execution time < X months ago,5
TASK_EXECUTION_LIST,2,true,DELETE FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Task execution belongs to Inactive task that need to be cleaned,6
TASK_REF_TABLES,3,true,DELETE FROM @TDMDB_SCHEMA@.TASK_REF_TABLES WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Task execution belongs to Inactive task that need to be cleaned,7
TASK_GLOBALS,3,true,DELETE FROM @TDMDB_SCHEMA@.TASK_GLOBALS WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Global belongs to a task that needs to be cleaned,8
TASKS_LOGICAL_UNITS,3,true,DELETE FROM @TDMDB_SCHEMA@.TASKS_LOGICAL_UNITS WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Records belong to tasks that need to be cleaned,9
TASKS,4,true,DELETE FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with task_status = 'Inactive' and task_last_updated_date < X months ago,10
ENVIRONMENT_ROLE_USERS,5,true,DELETE FROM @TDMDB_SCHEMA@.ENVIRONMENT_ROLE_USERS WHERE ROLE_ID IN (SELECT ROLE_ID FROM @TDMDB_SCHEMA@.ENVIRONMENT_ROLES WHERE UPPER(ROLE_STATUS) = 'INACTIVE' AND ROLE_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Entities with role_id that belongs to Inactive role that needs to be cleaned,12
ENVIRONMENT_ROLES,6,true,DELETE FROM @TDMDB_SCHEMA@.ENVIRONMENT_ROLES WHERE UPPER(ROLE_STATUS) = 'INACTIVE' AND ROLE_LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with role_status = 'Inactive' and role_last_updated_date < X months ago,13
ENVIRONMENT_PRODUCTS,6,true,DELETE FROM @TDMDB_SCHEMA@.ENVIRONMENT_PRODUCTS WHERE UPPER(STATUS) = 'INACTIVE' AND LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with status = 'Inactive' and last_updated_date < X months ago,14
ENVIRONMENT_OWNERS,7,true,DELETE FROM @TDMDB_SCHEMA@.ENVIRONMENT_OWNERS WHERE ENVIRONMENT_ID IN (SELECT ENVIRONMENT_ID FROM @TDMDB_SCHEMA@.ENVIRONMENTS WHERE UPPER(ENVIRONMENT_STATUS) = 'INACTIVE' AND ENVIRONMENT_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Owners of environments which need to be cleaned,17
TDM_ENV_GLOBALS,7,true,DELETE FROM @TDMDB_SCHEMA@.TDM_ENV_GLOBALS WHERE ENVIRONMENT_ID IN (SELECT ENVIRONMENT_ID FROM @TDMDB_SCHEMA@.ENVIRONMENTS WHERE UPPER(ENVIRONMENT_STATUS) = 'INACTIVE' AND ENVIRONMENT_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Globals belong to environment that needs to be cleaned,18
ENVIRONMENTS,8,true,DELETE FROM @TDMDB_SCHEMA@.ENVIRONMENTS WHERE UPPER(ENVIRONMENT_STATUS) = 'INACTIVE' AND ENVIRONMENT_LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with environment_status = 'Inactive' and environment_last_updated_date < X months ago,19
PRODUCTS,9,true,DELETE FROM @TDMDB_SCHEMA@.PRODUCTS WHERE UPPER(PRODUCT_STATUS) = 'INACTIVE' AND PRODUCT_LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with product_status = 'Inactive' and product_last_updated_date < X months ago,20
PRODUCT_LOGICAL_UNITS,10,true,DELETE FROM @TDMDB_SCHEMA@.PRODUCT_LOGICAL_UNITS WHERE BE_ID IN (SELECT BE_ID FROM @TDMDB_SCHEMA@.BUSINESS_ENTITIES WHERE UPPER(BE_STATUS) = 'INACTIVE' AND BE_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Entities with be_id belongs to Inactive business entity which needs to be cleaned,21
BUSINESS_ENTITIES,11,true,DELETE FROM @TDMDB_SCHEMA@.BUSINESS_ENTITIES WHERE UPPER(BE_STATUS) = 'INACTIVE' AND BE_LAST_UPDATED_DATE < ${TRUNC_DATE},Entities with be_status = 'Inactive' and be_last_updated_date < X months ago,22
TDM_BE_ENV_EXCLUSION_LIST,12,true,DELETE FROM @TDMDB_SCHEMA@.TDM_BE_ENV_EXCLUSION_LIST WHERE ENVIRONMENT_ID IN (SELECT ENVIRONMENT_ID FROM @TDMDB_SCHEMA@.ENVIRONMENTS  WHERE UPPER(ENVIRONMENT_STATUS) = 'INACTIVE' AND ENVIRONMENT_LAST_UPDATED_DATE < ${TRUNC_DATE} )  OR BE_ID IN (SELECT BE_ID FROM @TDMDB_SCHEMA@.BUSINESS_ENTITIES WHERE UPPER(BE_STATUS) = 'INACTIVE' AND BE_LAST_UPDATED_DATE < ${TRUNC_DATE} ),Records belong to environment that need to be cleaned or business entitiy that need to be cleaned,24
TASK_EXE_ERROR_DETAILED,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXE_ERROR_DETAILED WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",,25
TASK_EXE_STATS_DETAILED,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXE_STATS_DETAILED WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",,27
TASK_EXECUTION_OVERRIDE_ATTRS,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXECUTION_OVERRIDE_ATTRS WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",,28
TDM_RESERVED_ENTITIES,1,true,DELETE FROM @TDMDB_SCHEMA@.TDM_RESERVED_ENTITIES WHERE END_DATETIME < NOW(),,29
TDM_LU_TYPE_RELATION_EID,1,false,"DELETE FROM @TDMDB_SCHEMA@.TDM_LU_TYPE_RELATION_EID r where version_name <> '' and version_name||''||to_char(version_datetime, 'YYYYMMDDHH24MISS')||''||source_env in (select t.task_title||''||to_char(l.version_datetime, 'YYYYMMDDHH24MISS')||''||l.source_env_name from @TDMDB_SCHEMA@.tasks t,@TDMDB_SCHEMA@. task_Execution_list l where t.task_id = l.task_id and l.version_expiration_date <= NOW())",,30
TDM_GENERATE_TASK_FIELD_MAPPINGS,5,true,DELETE FROM @TDMDB_SCHEMA@.TDM_GENERATE_TASK_FIELD_MAPPINGS WHERE TASK_ID IN (SELECT TASK_ID FROM @TDMDB_SCHEMA@.TASKS WHERE UPPER(TASK_STATUS) = 'INACTIVE' AND TASK_LAST_UPDATED_DATE < ${TRUNC_DATE} ),A Generate task parameters records belong to tasks that need to be cleaned,32
TASK_EXECUTION_SUMMARY,1,true,"DELETE FROM @TDMDB_SCHEMA@.TASK_EXECUTION_SUMMARY WHERE TASK_EXECUTION_ID IN (SELECT TASK_EXECUTION_ID FROM @TDMDB_SCHEMA@.TASK_EXECUTION_LIST WHERE UPPER(EXECUTION_STATUS) NOT IN ('PENDING', 'RUNNING', 'WAITING') AND END_EXECUTION_TIME < ${TRUNC_DATE} )",,33
