{
    "tags": [
        "Setup"
    ],
    "levels": [
        {
            "stages": [
                {
                    "name": "Runtime",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "Now",
                            "actorType": {
                                "parentType": "Now",
                                "inputs": [],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Format",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "Now Formatted",
                            "actorType": {
                                "parentType": "DateFormat",
                                "inputs": [],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Developers Role",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "developers Role Exists",
                            "onError": "result",
                            "actorType": {
                                "parentType": "ErrorHandler",
                                "inputs": [
                                    {
                                        "name": "config",
                                        "const": [
                                            {
                                                "exceptionKey": "java.lang.Exception",
                                                "conditions": {
                                                    "message": "Role .* already exists"
                                                },
                                                "actions": {
                                                    "suppress": true,
                                                    "log": false,
                                                    "flowName": ""
                                                }
                                            }
                                        ]
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "developers Role",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE ROLE developers DESCRIPTION 'Developers Roles'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "developers ALL Permission",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL ON * TO developers"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "developers ALL_WS Permissions",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL_WS ON * TO developers"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "developers TDM Permission Groups",
                            "actorType": {
                                "parentType": "DbLoad",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "TDM"
                                    },
                                    {
                                        "name": "command",
                                        "const": "upsert"
                                    },
                                    {
                                        "name": "schema",
                                        "const": "public"
                                    },
                                    {
                                        "name": "table",
                                        "const": "permission_groups_mapping"
                                    },
                                    {
                                        "name": "fields",
                                        "const": [
                                            "description",
                                            "fabric_role",
                                            "permission_group",
                                            "created_by",
                                            "updated_by",
                                            "creation_date",
                                            "update_date"
                                        ]
                                    },
                                    {
                                        "name": "keys",
                                        "const": [
                                            "fabric_role"
                                        ]
                                    },
                                    {
                                        "name": "dialect",
                                        "const": "postgres"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    },
                                    {
                                        "const": "Developers Permission Group",
                                        "name": "description",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "developers",
                                        "name": "fabric_role",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "tester",
                                        "name": "permission_group",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "created_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "updated_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "creation_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "update_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Developers",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "yevgeni",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'yevgeni' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "yevgeni => developers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE developers to user 'yevgeni'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ale",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'ale' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ale => developers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE developers to user 'ale'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "venkata",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'venkata' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "venkata => developers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE developers to user 'venkata'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ajay",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'ajay' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ajay => developers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE developers to user 'ajay'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Testers Role",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "testers Role Exists",
                            "onError": "result",
                            "actorType": {
                                "parentType": "ErrorHandler",
                                "inputs": [
                                    {
                                        "name": "config",
                                        "const": [
                                            {
                                                "exceptionKey": "java.lang.Exception",
                                                "conditions": {
                                                    "message": "Role .* already exists"
                                                },
                                                "actions": {
                                                    "suppress": true,
                                                    "log": false,
                                                    "flowName": ""
                                                }
                                            }
                                        ]
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "testers Role",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE ROLE testers DESCRIPTION 'Testers Roles'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "testers ALL Permission",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL ON * TO testers"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "testers ALL_WS Permissions",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL_WS ON * TO testers"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "testers TDM Permission Groups",
                            "actorType": {
                                "parentType": "DbLoad",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "TDM"
                                    },
                                    {
                                        "name": "command",
                                        "const": "upsert"
                                    },
                                    {
                                        "name": "schema",
                                        "const": "public"
                                    },
                                    {
                                        "name": "table",
                                        "const": "permission_groups_mapping"
                                    },
                                    {
                                        "name": "fields",
                                        "const": [
                                            "description",
                                            "fabric_role",
                                            "permission_group",
                                            "created_by",
                                            "updated_by",
                                            "creation_date",
                                            "update_date"
                                        ]
                                    },
                                    {
                                        "name": "keys",
                                        "const": [
                                            "fabric_role"
                                        ]
                                    },
                                    {
                                        "name": "dialect",
                                        "const": "postgres"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    },
                                    {
                                        "const": "Testers Permission Group",
                                        "name": "description",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "testers",
                                        "name": "fabric_role",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "tester",
                                        "name": "permission_group",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "created_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "updated_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "creation_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "update_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Testers",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "hod",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'hod' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "hod => testers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE testers to user 'hod'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "diego",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'diego' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "diego => testers",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE testers to user 'diego'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Environment Owners Role",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "owners Role Exists",
                            "onError": "result",
                            "actorType": {
                                "parentType": "ErrorHandler",
                                "inputs": [
                                    {
                                        "name": "config",
                                        "const": [
                                            {
                                                "exceptionKey": "java.lang.Exception",
                                                "conditions": {
                                                    "message": "Role .* already exists"
                                                },
                                                "actions": {
                                                    "suppress": true,
                                                    "log": false,
                                                    "flowName": ""
                                                }
                                            }
                                        ]
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "owners Role",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE ROLE owners DESCRIPTION 'Environment Owners Roles'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "owners ALL Permission",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL ON * TO owners"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "owners ALL_WS Permissions",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "GRANT ALL_WS ON * TO owners"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "owners TDM Permission Groups",
                            "actorType": {
                                "parentType": "DbLoad",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "TDM"
                                    },
                                    {
                                        "name": "command",
                                        "const": "upsert"
                                    },
                                    {
                                        "name": "schema",
                                        "const": "public"
                                    },
                                    {
                                        "name": "table",
                                        "const": "permission_groups_mapping"
                                    },
                                    {
                                        "name": "fields",
                                        "const": [
                                            "description",
                                            "fabric_role",
                                            "permission_group",
                                            "created_by",
                                            "updated_by",
                                            "creation_date",
                                            "update_date"
                                        ]
                                    },
                                    {
                                        "name": "keys",
                                        "const": [
                                            "fabric_role"
                                        ]
                                    },
                                    {
                                        "name": "dialect",
                                        "const": "postgres"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    },
                                    {
                                        "const": "Environment Owners Permission Group",
                                        "name": "description",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "owners",
                                        "name": "fabric_role",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "owner",
                                        "name": "permission_group",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "created_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "const": "admin",
                                        "name": "updated_by",
                                        "schema": {
                                            "type": "string"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "creation_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    },
                                    {
                                        "name": "update_date",
                                        "schema": {
                                            "type": "date"
                                        },
                                        "mandatory": false
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        },
        {
            "stages": [
                {
                    "name": "Environment Owners",
                    "dependsOnList": [],
                    "isLast": 0,
                    "actors": [
                        {
                            "name": "brody",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'brody' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "brody => owners",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE owners to user 'brody'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ryan",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "CREATE USER IF NOT EXISTS 'ryan' WITH PASSWORD 'k2view'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        },
                        {
                            "name": "ryan => owners",
                            "actorType": {
                                "parentType": "DbCommand",
                                "inputs": [
                                    {
                                        "name": "interface",
                                        "const": "fabric"
                                    },
                                    {
                                        "name": "sql",
                                        "const": "ASSIGN ROLE owners to user 'ryan'"
                                    },
                                    {
                                        "name": "params",
                                        "schema": {
                                            "type": "object"
                                        },
                                        "const": {}
                                    }
                                ],
                                "outputs": []
                            }
                        }
                    ]
                }
            ]
        }
    ],
    "connections": [
        {
            "leftPort": {
                "actor": "Now",
                "name": "date"
            },
            "rightPort": {
                "actor": "Now Formatted",
                "name": "date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "developers TDM Permission Groups",
                "name": "creation_date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "developers TDM Permission Groups",
                "name": "update_date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "testers TDM Permission Groups",
                "name": "update_date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "testers TDM Permission Groups",
                "name": "creation_date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "owners TDM Permission Groups",
                "name": "creation_date"
            }
        },
        {
            "leftPort": {
                "actor": "Now Formatted",
                "name": "string"
            },
            "rightPort": {
                "actor": "owners TDM Permission Groups",
                "name": "update_date"
            }
        }
    ]
}